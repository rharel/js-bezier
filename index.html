<!DOCTYPE html>
<!--
/**
 * @author Raoul Harel
 * @license The MIT license (LICENSE.txt)
 * @copyright 2015 Raoul Harel
 * @url https://github.com/rharel/js-bezier
 */
-->
<html lang="en">
<head>
    <meta charset="UTF-8">

    <title>Bezier Curves</title>

    <link rel="stylesheet" href="css/demo.css">

    <script src="bower_components/js-bezier/dist/bezier.js"></script>
    <script src="js/CanvasView.js"></script>
    <script src="js/Animation.js"></script>
    <script>
        (function () {

            function _initialize() {

                var points_relative = _spiral(

                        0.5, 0.5,
                        0.4, 0.4,
                        0.1 * Math.PI, 1.9 * Math.PI,
                        7
                );
                var view = _create_view(points_relative, 'curve');
                view.shell.visible = true;
                view.shell.colors = [

                    'violet', 'indigo', 'blue', 'green', 'yellow', 'orange', 'red', 'black'
                ];
                view.shell.size = 1;
                view.outline.color = 'black';
                view.outline.precision = 0.025;
                view.points.color = 'violet';
                var animation = new Bezier.Animation(24, -1, 0.01);
                animation.animate(view);
            }

            function _create_view(points_relative, canvas_id) {

                var points_absolute;
                var curve, canvas, view;

                canvas = document.getElementById(canvas_id);
                points_absolute = points_relative.map(function(p) {

                    return {
                        x: p.x * canvas.width,
                        y: p.y * canvas.height
                    };
                });
                curve = new Bezier.Curve(points_absolute);
                view = new Bezier.CanvasView(curve, canvas.getContext('2d'));

                return view;
            }

            function _spiral(x, y, r0, r1, theta0, theta1, n) {

                var dr = (r1 - r0) / n;
                var dtheta = (theta1 - theta0) / n;

                var r = r0, theta = theta0;
                var points = [];
                for (var i = 0; i <= n; ++i) {

                    r = r0 + i * dr;
                    theta = theta0 + i * dtheta;
                    points.push({

                        x: x + r * Math.cos(theta),
                        y: y + r * Math.sin(theta)
                    });
                }

                return points;
            }

            window.addEventListener('load', _initialize);
        })();
    </script>
</head>
<body>

    <div id="content">
        <h1>
            <a href="https://www.github.com/rharel/js-bezier">
                rharel/js-bezier
            </a>
        </h1>

        <canvas id="curve" width="400" height="400"></canvas>
    </div>
</body>
</html>